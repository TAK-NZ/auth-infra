"use strict";
/**
 * Dynamic context override utilities
 * Simplified flat parameter system for command-line context overrides
 */
Object.defineProperty(exports, "__esModule", { value: true });
exports.applyContextOverrides = applyContextOverrides;
function applyContextOverrides(app, baseConfig) {
    const topLevelOverrides = {
        stackName: app.node.tryGetContext('stackName'),
    };
    return {
        ...baseConfig,
        ...Object.fromEntries(Object.entries(topLevelOverrides).filter(([_, v]) => v !== undefined)),
        database: {
            ...baseConfig.database,
            instanceClass: app.node.tryGetContext('instanceClass') ?? baseConfig.database.instanceClass,
            instanceCount: app.node.tryGetContext('instanceCount') ?? baseConfig.database.instanceCount,
            allocatedStorage: app.node.tryGetContext('allocatedStorage') ?? baseConfig.database.allocatedStorage,
            maxAllocatedStorage: app.node.tryGetContext('maxAllocatedStorage') ?? baseConfig.database.maxAllocatedStorage,
            enablePerformanceInsights: app.node.tryGetContext('enablePerformanceInsights') ?? baseConfig.database.enablePerformanceInsights,
            monitoringInterval: app.node.tryGetContext('monitoringInterval') ?? baseConfig.database.monitoringInterval,
            backupRetentionDays: app.node.tryGetContext('backupRetentionDays') ?? baseConfig.database.backupRetentionDays,
            deleteProtection: app.node.tryGetContext('deleteProtection') ?? baseConfig.database.deleteProtection,
        },
        redis: {
            ...baseConfig.redis,
            nodeType: app.node.tryGetContext('nodeType') ?? baseConfig.redis.nodeType,
            numCacheNodes: app.node.tryGetContext('numCacheNodes') ?? baseConfig.redis.numCacheNodes,
            enableTransit: app.node.tryGetContext('enableTransit') ?? baseConfig.redis.enableTransit,
            enableAtRest: app.node.tryGetContext('enableAtRest') ?? baseConfig.redis.enableAtRest,
        },
        ecs: {
            ...baseConfig.ecs,
            taskCpu: app.node.tryGetContext('taskCpu') ?? baseConfig.ecs.taskCpu,
            taskMemory: app.node.tryGetContext('taskMemory') ?? baseConfig.ecs.taskMemory,
            desiredCount: app.node.tryGetContext('desiredCount') ?? baseConfig.ecs.desiredCount,
            enableDetailedLogging: app.node.tryGetContext('enableDetailedLogging') ?? baseConfig.ecs.enableDetailedLogging,
        },
        authentik: {
            ...baseConfig.authentik,
            domain: app.node.tryGetContext('authentikDomain') ?? baseConfig.authentik.domain,
            adminUserEmail: app.node.tryGetContext('adminUserEmail') ?? baseConfig.authentik.adminUserEmail,
        },
        ldap: {
            ...baseConfig.ldap,
            domain: app.node.tryGetContext('ldapDomain') ?? baseConfig.ldap.domain,
        },
        general: {
            ...baseConfig.general,
            removalPolicy: app.node.tryGetContext('removalPolicy') || baseConfig.general.removalPolicy,
            enableDetailedLogging: app.node.tryGetContext('enableDetailedLogging') ?? baseConfig.general.enableDetailedLogging,
            enableContainerInsights: app.node.tryGetContext('enableContainerInsights') ?? baseConfig.general.enableContainerInsights,
        },
    };
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29udGV4dC1vdmVycmlkZXMuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJjb250ZXh0LW92ZXJyaWRlcy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUE7OztHQUdHOztBQUtILHNEQW9EQztBQXBERCxTQUFnQixxQkFBcUIsQ0FDbkMsR0FBWSxFQUNaLFVBQW9DO0lBRXBDLE1BQU0saUJBQWlCLEdBQUc7UUFDeEIsU0FBUyxFQUFFLEdBQUcsQ0FBQyxJQUFJLENBQUMsYUFBYSxDQUFDLFdBQVcsQ0FBQztLQUMvQyxDQUFDO0lBRUYsT0FBTztRQUNMLEdBQUcsVUFBVTtRQUNiLEdBQUcsTUFBTSxDQUFDLFdBQVcsQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDLGlCQUFpQixDQUFDLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLEVBQUUsRUFBRSxDQUFDLENBQUMsS0FBSyxTQUFTLENBQUMsQ0FBQztRQUM1RixRQUFRLEVBQUU7WUFDUixHQUFHLFVBQVUsQ0FBQyxRQUFRO1lBQ3RCLGFBQWEsRUFBRSxHQUFHLENBQUMsSUFBSSxDQUFDLGFBQWEsQ0FBQyxlQUFlLENBQUMsSUFBSSxVQUFVLENBQUMsUUFBUSxDQUFDLGFBQWE7WUFDM0YsYUFBYSxFQUFFLEdBQUcsQ0FBQyxJQUFJLENBQUMsYUFBYSxDQUFDLGVBQWUsQ0FBQyxJQUFJLFVBQVUsQ0FBQyxRQUFRLENBQUMsYUFBYTtZQUMzRixnQkFBZ0IsRUFBRSxHQUFHLENBQUMsSUFBSSxDQUFDLGFBQWEsQ0FBQyxrQkFBa0IsQ0FBQyxJQUFJLFVBQVUsQ0FBQyxRQUFRLENBQUMsZ0JBQWdCO1lBQ3BHLG1CQUFtQixFQUFFLEdBQUcsQ0FBQyxJQUFJLENBQUMsYUFBYSxDQUFDLHFCQUFxQixDQUFDLElBQUksVUFBVSxDQUFDLFFBQVEsQ0FBQyxtQkFBbUI7WUFDN0cseUJBQXlCLEVBQUUsR0FBRyxDQUFDLElBQUksQ0FBQyxhQUFhLENBQUMsMkJBQTJCLENB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ZXNDb250ZW50IjpbIi8qKlxuICogRHluYW1pYyBjb250ZXh0IG92ZXJyaWRlIHV0aWxpdGllc1xuICogU2ltcGxpZmllZCBmbGF0IHBhcmFtZXRlciBzeXN0ZW0gZm9yIGNvbW1hbmQtbGluZSBjb250ZXh0IG92ZXJyaWRlc1xuICovXG5cbmltcG9ydCAqIGFzIGNkayBmcm9tICdhd3MtY2RrLWxpYic7XG5pbXBvcnQgeyBDb250ZXh0RW52aXJvbm1lbnRDb25maWcgfSBmcm9tICcuLi9zdGFjay1jb25maWcnO1xuXG5leHBvcnQgZnVuY3Rpb24gYXBwbHlDb250ZXh0T3ZlcnJpZGVzKFxuICBhcHA6IGNkay5BcHAsIFxuICBiYXNlQ29uZmlnOiBDb250ZXh0RW52aXJvbm1lbnRDb25maWdcbik6IENvbnRleHRFbnZpcm9ubWVudENvbmZpZyB7XG4gIGNvbnN0IHRvcExldmVsT3ZlcnJpZGVzID0ge1xuICAgIHN0YWNrTmFtZTogYXBwLm5vZGUudHJ5R2V0Q29udGV4dCgnc3RhY2tOYW1lJyksXG4gIH07XG5cbiAgcmV0dXJuIHtcbiAgICAuLi5iYXNlQ29uZmlnLFxuICAgIC4uLk9iamVjdC5mcm9tRW50cmllcyhPYmplY3QuZW50cmllcyh0b3BMZXZlbE92ZXJyaWRlcykuZmlsdGVyKChbXywgdl0pID0+IHYgIT09IHVuZGVmaW5lZCkpLFxuICAgIGRhdGFiYXNlOiB7XG4gICAgICAuLi5iYXNlQ29uZmlnLmRhdGFiYXNlLFxuICAgICAgaW5zdGFuY2VDbGFzczogYXBwLm5vZGUudHJ5R2V0Q29udGV4dCgnaW5zdGFuY2VDbGFzcycpID8/IGJhc2VDb25maWcuZGF0YWJhc2UuaW5zdGFuY2VDbGFzcyxcbiAgICAgIGluc3RhbmNlQ291bnQ6IGFwcC5ub2RlLnRyeUdldENvbnRleHQoJ2luc3RhbmNlQ291bnQnKSA/PyBiYXNlQ29uZmlnLmRhdGFiYXNlLmluc3RhbmNlQ291bnQsXG4gICAgICBhbGxvY2F0ZWRTdG9yYWdlOiBhcHAubm9kZS50cnlHZXRDb250ZXh0KCdhbGxvY2F0ZWRTdG9yYWdlJykgPz8gYmFzZUNvbmZpZy5kYXRhYmFzZS5hbGxvY2F0ZWRTdG9yYWdlLFxuICAgICAgbWF4QWxsb2NhdGVkU3RvcmFnZTogYXBwLm5vZGUudHJ5R2V0Q29udGV4dCgnbWF4QWxsb2NhdGVkU3RvcmFnZScpID8/IGJhc2VDb25maWcuZGF0YWJhc2UubWF4QWxsb2NhdGVkU3RvcmFnZSxcbiAgICAgIGVuYWJsZVBlcmZvcm1hbmNlSW5zaWdodHM6IGFwcC5ub2RlLnRyeUdldENvbnRleHQoJ2VuYWJsZVBlcmZvcm1hbmNlSW5zaWdodHMnKSA/PyBiYXNlQ29uZmlnLmRhdGFiYXNlLmVuYWJsZVBlcmZvcm1hbmNlSW5zaWdodHMsXG4gICAgICBtb25pdG9yaW5nSW50ZXJ2YWw6IGFwcC5ub2RlLnRyeUdldENvbnRleHQoJ21vbml0b3JpbmdJbnRlcnZhbCcpID8/IGJhc2VDb25maWcuZGF0YWJhc2UubW9uaXRvcmluZ0ludGVydmFsLFxuICAgICAgYmFja3VwUmV0ZW50aW9uRGF5czogYXBwLm5vZGUudHJ5R2V0Q29udGV4dCgnYmFja3VwUmV0ZW50aW9uRGF5cycpID8/IGJhc2VDb25maWcuZGF0YWJhc2UuYmFja3VwUmV0ZW50aW9uRGF5cyxcbiAgICAgIGRlbGV0ZVByb3RlY3Rpb246IGFwcC5ub2RlLnRyeUdldENvbnRleHQoJ2RlbGV0ZVByb3RlY3Rpb24nKSA/PyBiYXNlQ29uZmlnLmRhdGFiYXNlLmRlbGV0ZVByb3RlY3Rpb24sXG4gICAgfSxcbiAgICByZWRpczoge1xuICAgICAgLi4uYmFzZUNvbmZpZy5yZWRpcyxcbiAgICAgIG5vZGVUeXBlOiBhcHAubm9kZS50cnlHZXRDb250ZXh0KCdub2RlVHlwZScpID8/IGJhc2VDb25maWcucmVkaXMubm9kZVR5cGUsXG4gICAgICBudW1DYWNoZU5vZGVzOiBhcHAubm9kZS50cnlHZXRDb250ZXh0KCdudW1DYWNoZU5vZGVzJykgPz8gYmFzZUNvbmZpZy5yZWRpcy5udW1DYWNoZU5vZGVzLFxuICAgICAgZW5hYmxlVHJhbnNpdDogYXBwLm5vZGUudHJ5R2V0Q29udGV4dCgnZW5hYmxlVHJhbnNpdCcpID8/IGJhc2VDb25maWcucmVkaXMuZW5hYmxlVHJhbnNpdCxcbiAgICAgIGVuYWJsZUF0UmVzdDogYXBwLm5vZGUudHJ5R2V0Q29udGV4dCgnZW5hYmxlQXRSZXN0JykgPz8gYmFzZUNvbmZpZy5yZWRpcy5lbmFibGVBdFJlc3QsXG4gICAgfSxcbiAgICBlY3M6IHtcbiAgICAgIC4uLmJhc2VDb25maWcuZWNzLFxuICAgICAgdGFza0NwdTogYXBwLm5vZGUudHJ5R2V0Q29udGV4dCgndGFza0NwdScpID8/IGJhc2VDb25maWcuZWNzLnRhc2tDcHUsXG4gICAgICB0YXNrTWVtb3J5OiBhcHAubm9kZS50cnlHZXRDb250ZXh0KCd0YXNrTWVtb3J5JykgPz8gYmFzZUNvbmZpZy5lY3MudGFza01lbW9yeSxcbiAgICAgIGRlc2lyZWRDb3VudDogYXBwLm5vZGUudHJ5R2V0Q29udGV4dCgnZGVzaXJlZENvdW50JykgPz8gYmFzZUNvbmZpZy5lY3MuZGVzaXJlZENvdW50LFxuICAgICAgZW5hYmxlRGV0YWlsZWRMb2dnaW5nOiBhcHAubm9kZS50cnlHZXRDb250ZXh0KCdlbmFibGVEZXRhaWxlZExvZ2dpbmcnKSA/PyBiYXNlQ29uZmlnLmVjcy5lbmFibGVEZXRhaWxlZExvZ2dpbmcsXG4gICAgfSxcbiAgICBhdXRoZW50aWs6IHtcbiAgICAgIC4uLmJhc2VDb25maWcuYXV0aGVudGlrLFxuICAgICAgZG9tYWluOiBhcHAubm9kZS50cnlHZXRDb250ZXh0KCdhdXRoZW50aWtEb21haW4nKSA/PyBiYXNlQ29uZmlnLmF1dGhlbnRpay5kb21haW4sXG4gICAgICBhZG1pblVzZXJFbWFpbDogYXBwLm5vZGUudHJ5R2V0Q29udGV4dCgnYWRtaW5Vc2VyRW1haWwnKSA/PyBiYXNlQ29uZmlnLmF1dGhlbnRpay5hZG1pblVzZXJFbWFpbCxcbiAgICB9LFxuICAgIGxkYXA6IHtcbiAgICAgIC4uLmJhc2VDb25maWcubGRhcCxcbiAgICAgIGRvbWFpbjogYXBwLm5vZGUudHJ5R2V0Q29udGV4dCgnbGRhcERvbWFpbicpID8/IGJhc2VDb25maWcubGRhcC5kb21haW4sXG4gICAgfSxcbiAgICBnZW5lcmFsOiB7XG4gICAgICAuLi5iYXNlQ29uZmlnLmdlbmVyYWwsXG4gICAgICByZW1vdmFsUG9saWN5OiBhcHAubm9kZS50cnlHZXRDb250ZXh0KCdyZW1vdmFsUG9saWN5JykgfHwgYmFzZUNvbmZpZy5nZW5lcmFsLnJlbW92YWxQb2xpY3ksXG4gICAgICBlbmFibGVEZXRhaWxlZExvZ2dpbmc6IGFwcC5ub2RlLnRyeUdldENvbnRleHQoJ2VuYWJsZURldGFpbGVkTG9nZ2luZycpID8/IGJhc2VDb25maWcuZ2VuZXJhbC5lbmFibGVEZXRhaWxlZExvZ2dpbmcsXG4gICAgICBlbmFibGVDb250YWluZXJJbnNpZ2h0czogYXBwLm5vZGUudHJ5R2V0Q29udGV4dCgnZW5hYmxlQ29udGFpbmVySW5zaWdodHMnKSA/PyBiYXNlQ29uZmlnLmdlbmVyYWwuZW5hYmxlQ29udGFpbmVySW5zaWdodHMsXG4gICAgfSxcbiAgfTtcbn1cbiJdfQ==